<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>360-degree Image Viewer</title>
    <script src="https://aframe.io/releases/1.2.0/aframe.min.js"></script>
    <style>
        /* Ensuring the A-Frame scene takes the full viewport */
        html, body, a-scene {
            height: 100%;
            width: 100%;
            margin: 0;
            padding: 0;
            overflow: hidden;
        }

        /* Styling the button container */
        #emojiBtnContainer {
            position: absolute;
            bottom: 1%; /* small margin from the bottom */
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            align-items: center;
            justify-content: center;
            transition: transform 0.3s;
        }

        /* Styling individual buttons */
        #emojiBtnContainer button {
            background: rgba(255, 255, 255, 0.5); /* partial opacity */
            border: none;
            border-radius: 15px;
            font-size: 20px;
            margin: 0 5px;
            padding: 10px 20px;
            cursor: pointer;
            transition: background 0.3s;
        }

        /* Button hover effect */
        #emojiBtnContainer button:hover {
            background: rgba(255, 255, 255, 0.8);
        }
      

        /* Making the button container scrollable horizontally */
        #emojiBtnContainer {
            overflow-x: scroll;
            white-space: nowrap;
            -webkit-overflow-scrolling: touch; /* iOS momentum scrolling */
        }
  
        /* Hide scrollbar but still make it scrollable */
        #emojiBtnContainer::-webkit-scrollbar {
            display: none;
        }

    </style>
</head>
<body>
    <a-scene embedded vr-mode-ui="enabled: true">
        <a-sky id="sky" src="https://raw.githubusercontent.com/RJain12/shanti/main/src/assets/IMG_9545.webp"></a-sky>
        <a-camera look-controls="reverseMouseDrag: true"></a-camera>
    </a-scene>

    <script>
        let speechRecognition = new webkitSpeechRecognition();

        speechRecognition.continuous = true;
        speechRecognition.lang = "en-US";
        speechRecognition.start()
        
        speechRecognition.onerror = function(event) {
            console.log(event.error);
        };
    
        speechRecognition.onresult = function (event) {
          const transcript = event.results[event.results.length - 1][0].transcript;
          console.log(transcript);
        };
    
        speechRecognition.onend = () => {
          speechRecognition.start();
        };
    </script>


    <script type="module">

        // const request = new Request("https://api.replicate.com/v1/predictions", {
        //     auth: "r8_c9Zyab1TtF8l60uN04WymVaW79LiKgh3MXx0L",
        //     mode: 'no-cors',
        //     method: "POST",
        //     body: {
        //       "version": "5c7d5dc6dd8bf75c1acaa8565735e7986bc5b66206b55cca93cb72c9bf15ccaa",
        //       "input": {
        //         "text": "Alice"
        //       }
        //   },
        // });

        // fetch(request)
        //   .then((response) => {
        //     console.log(response)
        //   });

        // const Replicate = require("replicate");

        // import fetch from 'node-fetch'
        const fretch = require("node-fetch")

        console.log("here");
        const response = await fetch("https://api.replicate.com/v1/predictions", {
            method: "POST",
            headers: {
              Authorization: `Token ${process.env.REPLICATE_API_TOKEN}`,
              "Content-Type": "application/json",
            },
            body: JSON.stringify({
              // Pinned to a specific version of Stable Diffusion
              // See https://replicate.com/stability-ai/sdxl
              version: "2b017d9b67edd2ee1401238df49d75da53c523f36e363881e057f5dc3ed3c5b2",

              // This is the text prompt that will be submitted by a form on the frontend
              input: { prompt: req.body.prompt },
            }),
          });

        console.log(response);


    </script>

    <script>
        function changeImage(imageSrc) {
            const skyElement = document.getElementById('sky');
            skyElement.setAttribute('src', "https://raw.githubusercontent.com/RJain12/shanti/main/src/assets/" + imageSrc);
        }

        document.addEventListener('DOMContentLoaded', function() {
            const container = document.getElementById('emojiBtnContainer');
            let touchStartX = 0;
            let touchEndX = 0;
            const threshold = 70; // The distance user must swipe to trigger a loop
  
            container.addEventListener('touchstart', function(event) {
                touchStartX = event.touches[0].clientX;
            });
  
            container.addEventListener('touchmove', function(event) {
                touchEndX = event.touches[0].clientX;
                handleSwipe();
            });
  
            function handleSwipe() {
                const buttons = container.querySelectorAll('button');
                const swipeDistance = Math.abs(touchStartX - touchEndX);
  
                if (swipeDistance < threshold) {
                    return; // Exit if swipe distance is less than threshold
                }
  
                if (touchEndX < touchStartX) {
                    // Swiped left
                    const firstButton = buttons[0];
                    container.removeChild(firstButton);
                    container.appendChild(firstButton);
                    touchStartX = touchEndX; // Reset the start position
                } else if (touchEndX > touchStartX) {
                    // Swiped right
                    const lastButton = buttons[buttons.length - 1];
                    container.removeChild(lastButton);
                    container.insertBefore(lastButton, buttons[0]);
                    touchStartX = touchEndX; // Reset the start position
                }
            }
        });


    </script>
</body>
</html>
